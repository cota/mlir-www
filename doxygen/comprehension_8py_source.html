<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MLIR: lib/Bindings/Python/mlir/dialects/linalg/opdsl/lang/comprehension.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MLIR
   &#160;<span id="projectnumber">13.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_9f56ffaf3d8f8de92886e7fdaecbdb83.html">Bindings</a></li><li class="navelem"><a class="el" href="dir_c298ce2707b4cc7f338c5c0280243548.html">Python</a></li><li class="navelem"><a class="el" href="dir_3ac1a85171091bc46bdab597ad0127d0.html">mlir</a></li><li class="navelem"><a class="el" href="dir_0ac2cc3262bf639e30b1d204a1839fcc.html">dialects</a></li><li class="navelem"><a class="el" href="dir_ef4da13e459411d6a6195507550065e7.html">linalg</a></li><li class="navelem"><a class="el" href="dir_c5f4b6ecf819d3438ddef1d30c07d7c1.html">opdsl</a></li><li class="navelem"><a class="el" href="dir_e2085f7427fbf3852c6d30836aa91729.html">lang</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">comprehension.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="comprehension_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacelinalg_1_1opdsl_1_1lang_1_1comprehension.html">    1</a></span>&#160;<span class="comment">#  Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">#  See https://llvm.org/LICENSE.txt for license information.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">#  SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="stringliteral">&quot;&quot;&quot;Model classes representing a tensor comprehension.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="stringliteral">These classes model the language more at an AST level as evaluated. Reasoning</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="stringliteral">about it typically involves processing this form into config objects that</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="stringliteral">represent actual op definitions (i.e. YAML).</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">from</span> typing <span class="keyword">import</span> Callable, Dict, List, Optional, Sequence, Set, Tuple, Union</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">from</span> mlir <span class="keyword">import</span> ir <span class="keyword">as</span> _ir</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">from</span> .affine <span class="keyword">import</span> *</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">from</span> .scalar_expr <span class="keyword">import</span> *</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">from</span> .types <span class="keyword">import</span> *</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">from</span> .yaml_helper <span class="keyword">import</span> *</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"># Type aliases.</span></div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="namespacelinalg_1_1opdsl_1_1lang_1_1comprehension.html#a3d8036fb36ca2bf13b12dc6d41de0709">   21</a></span>&#160;AffineDimList = Dict[str, _ir.AffineExpr]</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html">   24</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html">TensorExpression</a>:</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;An expression that can appear on the RHS of a comprehension.&quot;&quot;&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a06d34aa697e441f9e48707edf9c0e9c0">   27</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a06d34aa697e441f9e48707edf9c0e9c0">to_scalar_expression</a>(self) -&gt; ScalarExpression:</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">raise</span> NotImplementedError()</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#adb1e5f229344d18b658b24f284d55c47">   30</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#adb1e5f229344d18b658b24f284d55c47">visit_affine_exprs</a>(self, callback):</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Visits all affine expressions reachable by the expression.&quot;&quot;&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">pass</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keyword">def </span>_get_all_dim_defs(self) -&gt; Set[DimDef]:</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Recursively gets all DimDef affine expressions that are referenced.&quot;&quot;&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    results = set()</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">def </span>visitor(affine_expr):</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span> isinstance(affine_expr, DimDef):</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        results.add(affine_expr)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    self.visit_affine_exprs(visitor)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">return</span> results</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a8f871b5e8944f5b553dd333195a9ec88">   45</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a8f871b5e8944f5b553dd333195a9ec88">collect_uses</a>(self, uses: Set[<span class="stringliteral">&quot;TensorUse&quot;</span>]):</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Collects all TensorUses reachable through this expression.&quot;&quot;&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">pass</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a6a32bb7b3933d5f146934ab26961b66b">   49</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a6a32bb7b3933d5f146934ab26961b66b">__add__</a>(self, rhs: <span class="stringliteral">&quot;TensorExpression&quot;</span>) -&gt; <span class="stringliteral">&quot;TensorExpression&quot;</span>:</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">return</span> PrimFn.add(self, rhs)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a1dfe98c8ab7553fa2bd82c8d7b33d913">   52</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a1dfe98c8ab7553fa2bd82c8d7b33d913">__mul__</a>(self, rhs) -&gt; &quot;TensorExpression&quot;:</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">return</span> PrimFn.mul(self, rhs)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a02308d11b08a59b7e7f8c75487888721">   55</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a02308d11b08a59b7e7f8c75487888721">__sub__</a>(self, rhs) -&gt; &quot;TensorExpression&quot;:</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> PrimFn.sub(self, rhs)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a3eff16d4310fe6502328ce890e12fb46">   58</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a3eff16d4310fe6502328ce890e12fb46">__hash__</a>(self):</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">return</span> hash(id(self))</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html">   62</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html">TensorUse</a>(<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html">TensorExpression</a>):</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;A used tensor represented by its (tensor_name, indices).</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="stringliteral">  Note that forming a comprehension via direct assignment is performed through</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">  __setitem__ on the TensorDef level. However, performing a reduction with</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral">  compound ops (+=, *=, etc) is done by doing a:</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">    TensorDef.__getitem__</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">    TensorUse.__iadd__</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral">    TensorDef.__setitem__</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a279cd088f6f198f5b2361c07794948d3">   73</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a279cd088f6f198f5b2361c07794948d3">__init__</a>(self, tensor_def: <span class="stringliteral">&quot;TensorDef&quot;</span>, indices: Sequence[AffineExprDef]):</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7c0f27b7169e79c5c8a7011f996c7bde">   74</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7c0f27b7169e79c5c8a7011f996c7bde">tensor_def</a> = tensor_def</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a0d63edfe928909c4f50de93c29bfda18">   75</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a0d63edfe928909c4f50de93c29bfda18">indices</a> = tuple(indices)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7bae4a1124c536b3b3ec1bf006a5a3ac">   77</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7bae4a1124c536b3b3ec1bf006a5a3ac">to_scalar_expression</a>(self) -&gt; ScalarExpression:</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">assert</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7c0f27b7169e79c5c8a7011f996c7bde">tensor_def</a>.tensor_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarArg.html">ScalarArg</a>(self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7c0f27b7169e79c5c8a7011f996c7bde">tensor_def</a>.tensor_name).expr()</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  @property</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#aef5f67b86e112ffeae40ce1588963ca8">   82</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#aef5f67b86e112ffeae40ce1588963ca8">tensor_name</a>(self) -&gt; str:</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    n = self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7c0f27b7169e79c5c8a7011f996c7bde">tensor_def</a>.tensor_name</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">assert</span> n <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, <span class="stringliteral">&quot;TensorDef not attached&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">return</span> n</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a907506b3b43d19e22741d707f8f3be70">   87</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a907506b3b43d19e22741d707f8f3be70">visit_affine_exprs</a>(self, callback):</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">for</span> ind <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a0d63edfe928909c4f50de93c29bfda18">indices</a>:</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      ind.visit_affine_exprs(callback)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a2540073ea21353d279e50eb42211b807">   91</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a2540073ea21353d279e50eb42211b807">collect_uses</a>(self, uses: Set[<span class="stringliteral">&quot;TensorUse&quot;</span>]):</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    uses.add(self)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#ae5572a5c3275c65616b177f2dd93d849">   94</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#ae5572a5c3275c65616b177f2dd93d849">__iadd__</a>(self, rhs: TensorExpression) -&gt; TensorExpression:</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">return</span> ReduceFn.add(*self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a6ec9eb1ed2149ad42668ff59db35f5aa">_compute_reduce_dims</a>(rhs))(rhs)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keyword">def </span>_compute_reduce_dims(self, rhs: TensorExpression) -&gt; Set[DimDef]:</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;For implicit reductions, computes default reduction dims.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">    Assumes that the rhs is the expression being reduced and self is being</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral">    reduced into. Any indices referenced on the rhs and not in self are</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral">    considered reduction dims and will be ordered as encountered on the rhs.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    rhs_dims = rhs._get_all_dim_defs()</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    lhs_dims = self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a179a95eb7942cfeb18af19177c9536b2">_get_all_dim_defs</a>()</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> rhs_dims - lhs_dims</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#aa0b9d20d6207092c5db65e8c2ba1a3b7">  108</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#aa0b9d20d6207092c5db65e8c2ba1a3b7">__repr__</a>(self):</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">return</span> f<span class="stringliteral">&quot;{self.tensor_name}[{&#39;, &#39;.join([repr(i) for i in self.indices])}]&quot;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html">  112</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html">TensorDef</a>:</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Bookkeeping of a single registered tensor, held in dict by name.&quot;&quot;&quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a54c87edaf7a3e43fc009f04d5a0182ec">__init__</a>(self,</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a54c87edaf7a3e43fc009f04d5a0182ec">  116</a></span>&#160;               type_var: TypeVar,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;               *shape: AffineExprDef,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;               indexing_map: Optional[_ir.AffineMap] = <span class="keywordtype">None</span>,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;               output: bool = <span class="keyword">False</span>):</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(type_var, TypeVar):</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;TensorDef requires a TypeVar. Got: {repr(type_var)}&quot;</span>)</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6710870f6492a6929d64d846b0ffd750">  122</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6710870f6492a6929d64d846b0ffd750">owner</a> = <span class="keywordtype">None</span>  <span class="comment"># type: Optional[&quot;LinalgOpDef&quot;]</span></div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a9fe5712d63c4606309d3ac80e1be25cf">  123</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a9fe5712d63c4606309d3ac80e1be25cf">type_var</a> = type_var</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#aff4a45ac36cf46e8f7e8bde33ff67efe">  124</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#aff4a45ac36cf46e8f7e8bde33ff67efe">shape</a> = shape</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a235b07eb67ea0e7685000dceb3c76444">  125</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a235b07eb67ea0e7685000dceb3c76444">indexing_map</a> = indexing_map</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a66adc0a1c3e8e535c6f825dbe1cf3be5">  126</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a66adc0a1c3e8e535c6f825dbe1cf3be5">output</a> = output</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a8036f4196835e11f5f5470d3f76be9b9">  127</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a8036f4196835e11f5f5470d3f76be9b9">tensor_name</a> = <span class="keywordtype">None</span>  <span class="comment"># type: Optional[str]</span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#ae9f66b4439d159d20746c2d4316303dc">  128</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#ae9f66b4439d159d20746c2d4316303dc">registered_index</a> = -1  <span class="comment"># type: int</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  @property</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#afee8a6e7ec1fe98952b9831596a78d71">  131</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#afee8a6e7ec1fe98952b9831596a78d71">rank</a>(self) -&gt; int:</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;The rank of the tensor.&quot;&quot;&quot;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">return</span> len(self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#aff4a45ac36cf46e8f7e8bde33ff67efe">shape</a>)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a9d614ddb67eb3b61204a3c8c27f835fc">  135</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a9d614ddb67eb3b61204a3c8c27f835fc">attach</a>(self, index: int, tensor_name: str, owner: <span class="stringliteral">&quot;LinalgOpDef&quot;</span>):</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6710870f6492a6929d64d846b0ffd750">owner</a>:</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;TensorDef already registered with op: {self}&quot;</span>)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#ae9f66b4439d159d20746c2d4316303dc">registered_index</a> = index</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a8036f4196835e11f5f5470d3f76be9b9">tensor_name</a> = tensor_name</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6710870f6492a6929d64d846b0ffd750">owner</a> = owner</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#aebdcc0f7420e25fdae52c3023acd80bb">  142</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#aebdcc0f7420e25fdae52c3023acd80bb">__getitem__</a>(self, dims) -&gt; TensorUse:</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keyword">assert</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6710870f6492a6929d64d846b0ffd750">owner</a>, <span class="stringliteral">&quot;TensorDef is not attached to an op&quot;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    state = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1affine_1_1AffineBuildState.html">AffineBuildState</a>(global_state=self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6710870f6492a6929d64d846b0ffd750">owner</a>._affine_state,</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                             allow_new_symbols=<span class="keyword">False</span>)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(dims, tuple):</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      dims = (dims,)  <span class="comment"># Handle single subscript case.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment"># Special case: (None) is a 0d-scalar use.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> dims == (<span class="keywordtype">None</span>,):</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      dims = ()</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    exprs = []</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">for</span> expr_def <span class="keywordflow">in</span> dims:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(expr_def, AffineExprDef):</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">raise</span> KeyError(</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="stringliteral">&quot;A TensorDef can only be subscripted by a tuple of affine dims&quot;</span>)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      exprs.append(expr_def)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html">TensorUse</a>(self, exprs)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a124f3d5bb2021028528a651f2b5c25e4">  160</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a124f3d5bb2021028528a651f2b5c25e4">__setitem__</a>(self, dims, value):</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Creates a new 1:1 comprehension by binding this tensor to an expression.</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="stringliteral">    Note that due to the way assignment works in Python, we have to capture</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="stringliteral">    direct assignment as a setitem on the TensorDef.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(value, TensorExpression):</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Only TensorExpressions can be assigned to TensorDefs. &quot;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                       f<span class="stringliteral">&quot;Got: {repr(value)}&quot;</span>)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    use = self[dims]</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    comp = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html">Comprehension</a>((use, value))</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6710870f6492a6929d64d846b0ffd750">owner</a>.comprehensions.append(comp)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6fa59e00383ef7d01d116351880e5ab1">  173</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6fa59e00383ef7d01d116351880e5ab1">__hash__</a>(self):</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">return</span> hash(id(self))</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#acdc2ba8b78607d25ffabcc58e7d34a89">  176</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#acdc2ba8b78607d25ffabcc58e7d34a89">__repr__</a>(self):</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    output = <span class="stringliteral">&quot;OUTPUT &quot;</span> <span class="keywordflow">if</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a66adc0a1c3e8e535c6f825dbe1cf3be5">output</a> <span class="keywordflow">else</span> <span class="stringliteral">&quot;&quot;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">return</span> (f<span class="stringliteral">&quot;{self.tensor_name}:TensorDef({output}{repr(self.type_var)}, &quot;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            f<span class="stringliteral">&quot;shape={self.shape})&quot;</span>)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html">  182</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html">Comprehension</a>:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Represents a single comprehension.&quot;&quot;&quot;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a0d9577bdf93ea46c5072cabbc5c7775d">  185</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a0d9577bdf93ea46c5072cabbc5c7775d">__init__</a>(self, *bindings: Tuple[TensorUse, TensorExpression]):</div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#acb7719fe012fef63eacb880449406887">  186</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#acb7719fe012fef63eacb880449406887">definitions</a> = list()  <span class="comment"># List[TensorUse]</span></div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a8b43a28530a9c01834c55bd068d5afa1">  187</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a8b43a28530a9c01834c55bd068d5afa1">values</a> = list()  <span class="comment"># List[TensorExpression]</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment"># Find the lhs to reduction rhs.</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span> assign, value <span class="keywordflow">in</span> bindings:</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">if</span> isinstance(value, ReduceApply):</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> value.lhs:</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Reduction expression already assigns: {value}&quot;</span>)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        value.lhs = assign</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#acb7719fe012fef63eacb880449406887">definitions</a>.append(assign)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a8b43a28530a9c01834c55bd068d5afa1">values</a>.append(value)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  @property</div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a9acdc41c924c3514a560e25a75e93027">  199</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a9acdc41c924c3514a560e25a75e93027">all_reduction_dims</a>(self) -&gt; Set[Tuple[DimDef, ...]]:</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Gets the reduction dims for the comprehension or None.&quot;&quot;&quot;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    result = set()</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">for</span> use <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a8b43a28530a9c01834c55bd068d5afa1">values</a>:</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span> isinstance(use, ReduceApply):</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        result.add(use.reduce.reduce_dims)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">else</span>:</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        result.add(tuple())</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">return</span> result</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a1d500ad7e0f16fb05400b832d9bc42e4">  209</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a1d500ad7e0f16fb05400b832d9bc42e4">__repr__</a>(self):</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span> len(self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#acb7719fe012fef63eacb880449406887">definitions</a>) &gt; 1:</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      defs_repr = f<span class="stringliteral">&quot;({&#39;, &#39;.join(repr(d) for d in self.definitions)})&quot;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      values_repr = f<span class="stringliteral">&quot;({&#39;, &#39;.join(repr(v) for v in self.values)})&quot;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      defs_repr = f<span class="stringliteral">&quot;{repr(self.definitions[0])}&quot;</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      values_repr = f<span class="stringliteral">&quot;{repr(self.values[0])}&quot;</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> f<span class="stringliteral">&quot;{defs_repr} = {values_repr}&quot;</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">  220</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">PrimFnType</a>:</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Primitive operations.&quot;&quot;&quot;</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a182ed5c441939a7e5e3d5974ab85a47c">  223</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a182ed5c441939a7e5e3d5974ab85a47c">__init__</a>(self, prim_name: str):</div><div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a4ee9313746f2fdf66001f25f50a9466d">  224</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a4ee9313746f2fdf66001f25f50a9466d">prim_name</a> = prim_name</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#ab5fdfaffe642492b99880383772e9e4f">  226</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#ab5fdfaffe642492b99880383772e9e4f">__call__</a>(self, *args):</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html">PrimApply</a>(self, args)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#af7faa74bb77018a69b0691f2cc5a7383">  229</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#af7faa74bb77018a69b0691f2cc5a7383">reduce</a>(self, *reduce_dims: DimDef):</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Shortcut to create a Reduce operation from this primitive.&quot;&quot;&quot;</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html">ReduceFnType</a>(self, *reduce_dims)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a743acbc6ef83ed6a67cc21aa9f9ff0f2">  233</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a743acbc6ef83ed6a67cc21aa9f9ff0f2">__repr__</a>(self):</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> f<span class="stringliteral">&quot;{self.prim_name}&quot;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html">  237</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html">PrimFn</a>:</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html#ae6a09933a9cd86e1d273667b864a45c4">  238</a></span>&#160;  add = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">PrimFnType</a>(<span class="stringliteral">&quot;add&quot;</span>)</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html#ac71f8b0ea0ec37ed405803041b551683">  239</a></span>&#160;  exp = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">PrimFnType</a>(<span class="stringliteral">&quot;exp&quot;</span>)</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html#a6b984f5859edf7205b26a299ed49081e">  240</a></span>&#160;  log = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">PrimFnType</a>(<span class="stringliteral">&quot;log&quot;</span>)</div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html#ada03132d981bacf3c00619038b1226f2">  241</a></span>&#160;  mul = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">PrimFnType</a>(<span class="stringliteral">&quot;mul&quot;</span>)</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html#a56050880104adf88fce50aa29609c1c2">  242</a></span>&#160;  max = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">PrimFnType</a>(<span class="stringliteral">&quot;max&quot;</span>)</div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html#a579cbad0f21b8b041e5c3c253cff6283">  243</a></span>&#160;  sub = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">PrimFnType</a>(<span class="stringliteral">&quot;sub&quot;</span>)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html">  246</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html">ReduceFnType</a>:</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;A reduction operator that reduces into its LHS from its RHS.&quot;&quot;&quot;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a5d0597e534a0115d6f99b54a6629e0bf">  249</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a5d0597e534a0115d6f99b54a6629e0bf">__init__</a>(self, operator: PrimFnType, *reduce_dims: DimDef):</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Initializes the ReduceFn with a primitive function and dims.&quot;&quot;&quot;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(operator, PrimFnType):</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Reduce expected a Prim operator. Got: {operator}&quot;</span>)</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a342e4594c2ebe591dd03f3fbf8515c3e">  253</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a342e4594c2ebe591dd03f3fbf8515c3e">operator</a> = operator</div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a3657a5bbf8c376432138654b132a01cc">  254</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a3657a5bbf8c376432138654b132a01cc">reduce_dims</a> = tuple(reduce_dims)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a536d883c506d44c9a6215cf6780c6a11">  256</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a536d883c506d44c9a6215cf6780c6a11">__call__</a>(self, *args: TensorExpression):</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html">ReduceApply</a>(self, args)</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a038f03c4b832d6642ea973ea101048db">  259</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a038f03c4b832d6642ea973ea101048db">__repr__</a>(self):</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">return</span> (f<span class="stringliteral">&quot;reduce_{self.operator.prim_name}&quot;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            f<span class="stringliteral">&quot;({&#39;, &#39;.join(repr(d) for d in self.reduce_dims)})&quot;</span>)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFn.html">  264</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFn.html">ReduceFn</a>:</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFn.html#a4257009db6aa1988a4772f62eeecb8fc">  265</a></span>&#160;  add = PrimFn.add.reduce</div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFn.html#a71289e08722bc8ff640669c2ad23e57b">  266</a></span>&#160;  mul = PrimFn.mul.reduce</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFn.html#af521e0792c95d5e1fe3fbe8d455d2554">  267</a></span>&#160;  max = PrimFn.max.reduce</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html">  270</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html">PrimApply</a>(<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html">TensorExpression</a>):</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Application of a primitive.&quot;&quot;&quot;</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a9c0964fef9a9dc4bc34c4359d02a3e92">  273</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a9c0964fef9a9dc4bc34c4359d02a3e92">__init__</a>(self, prim: PrimFnType, args: Sequence[TensorExpression]):</div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a4d0cc96bb15db3929307eb28ecd57303">  274</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a4d0cc96bb15db3929307eb28ecd57303">prim</a> = prim</div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a007e74226bad56c1fe0348e28b66d261">  275</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a007e74226bad56c1fe0348e28b66d261">args</a> = tuple(args)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#ad1b2a9c3a44fc8f9cbfdf1f333eba124">  277</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#ad1b2a9c3a44fc8f9cbfdf1f333eba124">to_scalar_expression</a>(self) -&gt; ScalarExpression:</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarApplyFn.html">ScalarApplyFn</a>(self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a4d0cc96bb15db3929307eb28ecd57303">prim</a>.prim_name,</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                         *[arg.to_scalar_expression() <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a007e74226bad56c1fe0348e28b66d261">args</a></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                          ]).expr()</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#ab5422aa4aad2f31c59f7240dd3d5bc8a">  282</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#ab5422aa4aad2f31c59f7240dd3d5bc8a">visit_affine_exprs</a>(self, callback):</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a007e74226bad56c1fe0348e28b66d261">args</a>:</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      arg.visit_affine_exprs(callback)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a9e27c23b9e13e192320672b1796e1523">  286</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a9e27c23b9e13e192320672b1796e1523">collect_uses</a>(self, uses: Set[<span class="stringliteral">&quot;TensorUse&quot;</span>]):</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a007e74226bad56c1fe0348e28b66d261">args</a>:</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      arg.collect_uses(uses)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#acd691359a2e2590e48da48766a6aa5fc">  290</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#acd691359a2e2590e48da48766a6aa5fc">__repr__</a>(self):</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span> f<span class="stringliteral">&quot;{repr(self.prim)}({&#39;, &#39;.join(repr(a) for a in self.args)})&quot;</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html">  294</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html">cast</a>(<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html">TensorExpression</a>):</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Casts the element type to a type (typically symbolic TypeVar).&quot;&quot;&quot;</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a83dcb8567c9c7ecd4647ed3a6a03804b">  297</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a83dcb8567c9c7ecd4647ed3a6a03804b">__init__</a>(self, to_type: TypeVar, operand: TensorExpression):</div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#ab1b1e910ee80c2d8bf4cae08375390f3">  298</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#ab1b1e910ee80c2d8bf4cae08375390f3">to_type</a> = to_type</div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a5e564b4bf2d423f451aff2e6ed4bf48a">  299</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a5e564b4bf2d423f451aff2e6ed4bf48a">operand</a> = operand</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#aa6a1a8d2335c03b8cdbb635999e478c0">  301</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#aa6a1a8d2335c03b8cdbb635999e478c0">to_scalar_expression</a>(self) -&gt; ScalarExpression:</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarSymbolicCast.html">ScalarSymbolicCast</a>(self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#ab1b1e910ee80c2d8bf4cae08375390f3">to_type</a>,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                              self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a5e564b4bf2d423f451aff2e6ed4bf48a">operand</a>.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#aa6a1a8d2335c03b8cdbb635999e478c0">to_scalar_expression</a>()).expr()</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#ac1a303348e20186dea26a69bf6a9a6f0">  305</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#ac1a303348e20186dea26a69bf6a9a6f0">visit_affine_exprs</a>(self, callback):</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a5e564b4bf2d423f451aff2e6ed4bf48a">operand</a>.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#ac1a303348e20186dea26a69bf6a9a6f0">visit_affine_exprs</a>(callback)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a2f4025064f9d8b96651d5c4430515177">  308</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a2f4025064f9d8b96651d5c4430515177">collect_uses</a>(self, uses: Set[<span class="stringliteral">&quot;TensorUse&quot;</span>]):</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a5e564b4bf2d423f451aff2e6ed4bf48a">operand</a>.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a2f4025064f9d8b96651d5c4430515177">collect_uses</a>(uses)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a2a9d61ad327e6fdabd79347dde07e0ee">  311</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a2a9d61ad327e6fdabd79347dde07e0ee">__repr__</a>(self):</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> f<span class="stringliteral">&quot;cast({self.to_type}, {repr(self.operand)})&quot;</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html">  315</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html">ReduceApply</a>(<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html">TensorExpression</a>):</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Application of a reduction.</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="stringliteral">  This captures the lhs separately (initial value) separately from the rhs.</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="stringliteral">  &quot;&quot;&quot;</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a60095515a35ad0efdb353d563a2e51d2">  321</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a60095515a35ad0efdb353d563a2e51d2">__init__</a>(self, reduce: ReduceFnType, args: Sequence[TensorExpression]):</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#af3e94e5e30080fa8306dabe897b72faa">  322</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#af3e94e5e30080fa8306dabe897b72faa">reduce</a> = reduce</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#acaa7656d8a3f82052415732ca9728095">  323</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#acaa7656d8a3f82052415732ca9728095">lhs</a> = <span class="keywordtype">None</span>  <span class="comment"># type: Optional[TensorUse]</span></div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a228c80d8d8f4d63ed6f9359e805209a0">  324</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a228c80d8d8f4d63ed6f9359e805209a0">args</a> = tuple(args)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a7d2455e9e1bdb7b6fe18aed2fe73b2b9">  326</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a7d2455e9e1bdb7b6fe18aed2fe73b2b9">to_scalar_expression</a>(self) -&gt; ScalarExpression:</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#acaa7656d8a3f82052415732ca9728095">lhs</a> <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Cannot scalarize a ReduceApply that has not been &quot;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                       f<span class="stringliteral">&quot;bound to its lhs: {self}&quot;</span>)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    full_args = [self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#acaa7656d8a3f82052415732ca9728095">lhs</a>.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a7d2455e9e1bdb7b6fe18aed2fe73b2b9">to_scalar_expression</a>()</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                ] + [arg.to_scalar_expression() <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a228c80d8d8f4d63ed6f9359e805209a0">args</a>]</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarApplyFn.html">ScalarApplyFn</a>(self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#af3e94e5e30080fa8306dabe897b72faa">reduce</a>.operator.prim_name, *full_args).expr()</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#ae6a29824a3cea4ad2624f3044ed056d8">  334</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#ae6a29824a3cea4ad2624f3044ed056d8">visit_affine_exprs</a>(self, callback):</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">for</span> ind <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#af3e94e5e30080fa8306dabe897b72faa">reduce</a>.reduce_dims:</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      ind.visit_affine_exprs(callback)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a228c80d8d8f4d63ed6f9359e805209a0">args</a>:</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      arg.visit_affine_exprs(callback)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a690dce45e1c476acf148e7e956456bee">  340</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a690dce45e1c476acf148e7e956456bee">collect_uses</a>(self, uses: Set[<span class="stringliteral">&quot;TensorUse&quot;</span>]):</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a228c80d8d8f4d63ed6f9359e805209a0">args</a>:</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      arg.collect_uses(uses)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#aac3471e85cf22ac516e101e9d891d215">  344</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#aac3471e85cf22ac516e101e9d891d215">__repr__</a>(self):</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> f<span class="stringliteral">&quot;{repr(self.reduce)}({&#39;, &#39;.join(repr(a) for a in self.args)})&quot;</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html">  348</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html">OpInterfaceDef</a>:</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;An interface that an op implements.&quot;&quot;&quot;</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html#a96ab98d44a9af2421021e17d5ee23b99">  351</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html#a96ab98d44a9af2421021e17d5ee23b99">__init__</a>(self, cpp_name: str):</div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html#a801f5085487094139fefacb2361d27e8">  352</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html#a801f5085487094139fefacb2361d27e8">cpp_name</a> = cpp_name</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="namespacelinalg_1_1opdsl_1_1lang_1_1comprehension.html#ade47368ebecd8abb2e6b8e391c32f816">  355</a></span>&#160;ContractionOpInterface = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html">OpInterfaceDef</a>(<span class="stringliteral">&quot;LinalgContractionOpInterface&quot;</span>)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html">  358</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html">OpMetadataDef</a>(<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1yaml__helper_1_1YAMLObject.html">YAMLObject</a>):</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Metadata about the op (generally not behavior impacting).&quot;&quot;&quot;</span></div><div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#a201fca7c8bc97b0f81580b2facc1a7cd">  360</a></span>&#160;  yaml_tag = <span class="stringliteral">&quot;!LinalgOpMetadata&quot;</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#a79b808a15e62c0c811fe47c43d7269dc">  362</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#a79b808a15e62c0c811fe47c43d7269dc">__init__</a>(self, name: str, cpp_class_name: Optional[str], doc: Optional[str]):</div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#ae76d5f02087ef4c671b65f2b51821f36">  363</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#ae76d5f02087ef4c671b65f2b51821f36">name</a> = name</div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#afac87d852d434139e63957c8beb26497">  364</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#afac87d852d434139e63957c8beb26497">cpp_class_name</a> = cpp_class_name <span class="keywordflow">if</span> cpp_class_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> name</div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#ad017798fea096c33f7774beb4add208b">  365</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#ad017798fea096c33f7774beb4add208b">doc</a> = doc</div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#aeba44172d4629929cf6e1b64fd242f63">  366</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#aeba44172d4629929cf6e1b64fd242f63">implements</a> = []  <span class="comment"># type: List[OpInterfaceDef]</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#a2b0baa286b8cd65a1d739df2405477c6">  368</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#a2b0baa286b8cd65a1d739df2405477c6">to_yaml_custom_dict</a>(self):</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    d = dict(</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        name=self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#ae76d5f02087ef4c671b65f2b51821f36">name</a>,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        cpp_class_name=self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#afac87d852d434139e63957c8beb26497">cpp_class_name</a>,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        doc=self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#ad017798fea096c33f7774beb4add208b">doc</a>,</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    )</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#aeba44172d4629929cf6e1b64fd242f63">implements</a>:</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      d[<span class="stringliteral">&quot;implements&quot;</span>] = [intr.cpp_name <span class="keywordflow">for</span> intr <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#aeba44172d4629929cf6e1b64fd242f63">implements</a>]</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">return</span> d</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html">  379</a></span>&#160;<span class="keyword">class </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html">LinalgOpDef</a>:</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="stringliteral">&quot;&quot;&quot;Definition of a linalg op.&quot;&quot;&quot;</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#af16e2baa698b29ad36bd60cd1a6491c9">__init__</a>(self,</div><div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#af16e2baa698b29ad36bd60cd1a6491c9">  383</a></span>&#160;               name: str,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;               cpp_class_name: Optional[str] = <span class="keywordtype">None</span>,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;               doc: Optional[str] = <span class="keywordtype">None</span>):</div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#afa359a51c020db58fbbf50e8a6a2af8a">  386</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#afa359a51c020db58fbbf50e8a6a2af8a">metadata</a> = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html">OpMetadataDef</a>(name=name, cpp_class_name=cpp_class_name, doc=doc)</div><div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">  387</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">registered_tensors</a> = dict()  <span class="comment"># type: Dict[str, TensorDef]</span></div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a7ba52198e7f358ce016b6c9e9dc7ea62">  388</a></span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a7ba52198e7f358ce016b6c9e9dc7ea62">comprehensions</a> = list()  <span class="comment"># type: List[Comprehension]</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#aca83439ab795f43906b8b57dddea9afa">_affine_state</a> = <a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1affine_1_1AffineBuildState.html">AffineBuildState</a>()</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  @property</div><div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a0ee8d1ec3b746c4a4d91e3a897c8a598">  392</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a0ee8d1ec3b746c4a4d91e3a897c8a598">inputs</a>(self) -&gt; Sequence[TensorDef]:</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">return</span> [t <span class="keywordflow">for</span> t <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">registered_tensors</a>.values() <span class="keywordflow">if</span> <span class="keywordflow">not</span> t.output]</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  @property</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#adcb5271ae1d3db4adcf9e932681edcce">  396</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#adcb5271ae1d3db4adcf9e932681edcce">outputs</a>(self) -&gt; Sequence[TensorDef]:</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span> [t <span class="keywordflow">for</span> t <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">registered_tensors</a>.values() <span class="keywordflow">if</span> t.output]</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a4d8db802177b8e2f445dc2a85a656d9f">  399</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a4d8db802177b8e2f445dc2a85a656d9f">add_tensor</a>(self, tensor_name: str, tensor: TensorDef):</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Registers a tensor.&quot;&quot;&quot;</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> tensor_name <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">registered_tensors</a>:</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Tensor {tensor_name} is already registered &quot;</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                       f<span class="stringliteral">&quot;to {self.registered_tensors[&#39;tensor_name&#39;]}&quot;</span>)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    tensor.attach(len(self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">registered_tensors</a>), tensor_name, self)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">registered_tensors</a>[tensor_name] = tensor</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a1f91d53e1a01e942419aef26fe8c66e7">  407</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a1f91d53e1a01e942419aef26fe8c66e7">tensor</a>(self, name):</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Gets a registered tensor by name.&quot;&quot;&quot;</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">return</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">registered_tensors</a>[name]</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">except</span> KeyError:</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">raise</span> KeyError(f<span class="stringliteral">&quot;Tensor {name} is not registered&quot;</span>)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#add9793d6f4d2a833f964a67c565a61ec">  414</a></span>&#160;  <span class="keyword">def </span><a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#add9793d6f4d2a833f964a67c565a61ec">__repr__</a>(self):</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    lines = [</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        f<span class="stringliteral">&quot;LinalgOpDef({self.metadata.name} -&gt; {self.metadata.cpp_class_name},&quot;</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    ]</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">for</span> name, tensor <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">registered_tensors</a>.items():</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      lines.append(f<span class="stringliteral">&quot;  {tensor}&quot;</span>)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a7ba52198e7f358ce016b6c9e9dc7ea62">comprehensions</a>:</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      lines[-1] += <span class="stringliteral">&quot; {&quot;</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">for</span> comprehension <span class="keywordflow">in</span> self.<a class="code" href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a7ba52198e7f358ce016b6c9e9dc7ea62">comprehensions</a>:</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        lines.append(f<span class="stringliteral">&quot;    {comprehension}&quot;</span>)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      lines.append(<span class="stringliteral">&quot;}&quot;</span>)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;\n&quot;</span>.join(lines)</div><div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType_html_a743acbc6ef83ed6a67cc21aa9f9ff0f2"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a743acbc6ef83ed6a67cc21aa9f9ff0f2">linalg.opdsl.lang.comprehension.PrimFnType.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00233">comprehension.py:233</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html_a06d34aa697e441f9e48707edf9c0e9c0"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a06d34aa697e441f9e48707edf9c0e9c0">linalg.opdsl.lang.comprehension.TensorExpression.to_scalar_expression</a></div><div class="ttdeci">def to_scalar_expression(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00027">comprehension.py:27</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_aa0b9d20d6207092c5db65e8c2ba1a3b7"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#aa0b9d20d6207092c5db65e8c2ba1a3b7">linalg.opdsl.lang.comprehension.TensorUse.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00108">comprehension.py:108</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType_html_a182ed5c441939a7e5e3d5974ab85a47c"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a182ed5c441939a7e5e3d5974ab85a47c">linalg.opdsl.lang.comprehension.PrimFnType.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00223">comprehension.py:223</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_a7bae4a1124c536b3b3ec1bf006a5a3ac"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7bae4a1124c536b3b3ec1bf006a5a3ac">linalg.opdsl.lang.comprehension.TensorUse.to_scalar_expression</a></div><div class="ttdeci">def to_scalar_expression(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00077">comprehension.py:77</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html">linalg.opdsl.lang.comprehension.OpMetadataDef</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00358">comprehension.py:358</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a235b07eb67ea0e7685000dceb3c76444"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a235b07eb67ea0e7685000dceb3c76444">linalg.opdsl.lang.comprehension.TensorDef.indexing_map</a></div><div class="ttdeci">indexing_map</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00125">comprehension.py:125</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html_a6a32bb7b3933d5f146934ab26961b66b"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a6a32bb7b3933d5f146934ab26961b66b">linalg.opdsl.lang.comprehension.TensorExpression.__add__</a></div><div class="ttdeci">def __add__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00049">comprehension.py:49</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html_a179a95eb7942cfeb18af19177c9536b2"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a179a95eb7942cfeb18af19177c9536b2">linalg.opdsl.lang.comprehension.TensorExpression._get_all_dim_defs</a></div><div class="ttdeci">def _get_all_dim_defs(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00034">comprehension.py:34</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply_html_acd691359a2e2590e48da48766a6aa5fc"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#acd691359a2e2590e48da48766a6aa5fc">linalg.opdsl.lang.comprehension.PrimApply.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00290">comprehension.py:290</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html_acaa7656d8a3f82052415732ca9728095"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#acaa7656d8a3f82052415732ca9728095">linalg.opdsl.lang.comprehension.ReduceApply.lhs</a></div><div class="ttdeci">lhs</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00323">comprehension.py:323</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a6fa59e00383ef7d01d116351880e5ab1"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6fa59e00383ef7d01d116351880e5ab1">linalg.opdsl.lang.comprehension.TensorDef.__hash__</a></div><div class="ttdeci">def __hash__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00173">comprehension.py:173</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html">linalg.opdsl.lang.comprehension.cast</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00294">comprehension.py:294</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_aebdcc0f7420e25fdae52c3023acd80bb"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#aebdcc0f7420e25fdae52c3023acd80bb">linalg.opdsl.lang.comprehension.TensorDef.__getitem__</a></div><div class="ttdeci">def __getitem__(self, dims)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00142">comprehension.py:142</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_a7c0f27b7169e79c5c8a7011f996c7bde"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a7c0f27b7169e79c5c8a7011f996c7bde">linalg.opdsl.lang.comprehension.TensorUse.tensor_def</a></div><div class="ttdeci">tensor_def</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00074">comprehension.py:74</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType_html_ab5fdfaffe642492b99880383772e9e4f"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#ab5fdfaffe642492b99880383772e9e4f">linalg.opdsl.lang.comprehension.PrimFnType.__call__</a></div><div class="ttdeci">def __call__(self, args)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00226">comprehension.py:226</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html_a690dce45e1c476acf148e7e956456bee"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a690dce45e1c476acf148e7e956456bee">linalg.opdsl.lang.comprehension.ReduceApply.collect_uses</a></div><div class="ttdeci">def collect_uses</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00340">comprehension.py:340</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension_html_acb7719fe012fef63eacb880449406887"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#acb7719fe012fef63eacb880449406887">linalg.opdsl.lang.comprehension.Comprehension.definitions</a></div><div class="ttdeci">definitions</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00186">comprehension.py:186</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_a6ec9eb1ed2149ad42668ff59db35f5aa"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a6ec9eb1ed2149ad42668ff59db35f5aa">linalg.opdsl.lang.comprehension.TensorUse._compute_reduce_dims</a></div><div class="ttdeci">def _compute_reduce_dims</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00097">comprehension.py:97</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_aca83439ab795f43906b8b57dddea9afa"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#aca83439ab795f43906b8b57dddea9afa">linalg.opdsl.lang.comprehension.LinalgOpDef._affine_state</a></div><div class="ttdeci">_affine_state</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00389">comprehension.py:389</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply_html_a007e74226bad56c1fe0348e28b66d261"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a007e74226bad56c1fe0348e28b66d261">linalg.opdsl.lang.comprehension.PrimApply.args</a></div><div class="ttdeci">args</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00275">comprehension.py:275</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension_html_a0d9577bdf93ea46c5072cabbc5c7775d"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a0d9577bdf93ea46c5072cabbc5c7775d">linalg.opdsl.lang.comprehension.Comprehension.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00185">comprehension.py:185</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_afee8a6e7ec1fe98952b9831596a78d71"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#afee8a6e7ec1fe98952b9831596a78d71">linalg.opdsl.lang.comprehension.TensorDef.rank</a></div><div class="ttdeci">def rank(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00131">comprehension.py:131</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1yaml__helper_1_1YAMLObject_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1yaml__helper_1_1YAMLObject.html">linalg.opdsl.lang.yaml_helper.YAMLObject</a></div><div class="ttdef"><b>Definition:</b> <a href="yaml__helper_8py_source.html#l00022">yaml_helper.py:22</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html">linalg.opdsl.lang.comprehension.Comprehension</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00182">comprehension.py:182</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html">linalg.opdsl.lang.comprehension.PrimFnType</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00220">comprehension.py:220</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarApplyFn_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarApplyFn.html">linalg.opdsl.lang.scalar_expr.ScalarApplyFn</a></div><div class="ttdef"><b>Definition:</b> <a href="scalar__expr_8py_source.html#l00030">scalar_expr.py:30</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef_html_a96ab98d44a9af2421021e17d5ee23b99"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html#a96ab98d44a9af2421021e17d5ee23b99">linalg.opdsl.lang.comprehension.OpInterfaceDef.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00351">comprehension.py:351</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html_a228c80d8d8f4d63ed6f9359e805209a0"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a228c80d8d8f4d63ed6f9359e805209a0">linalg.opdsl.lang.comprehension.ReduceApply.args</a></div><div class="ttdeci">args</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00324">comprehension.py:324</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html_a60095515a35ad0efdb353d563a2e51d2"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a60095515a35ad0efdb353d563a2e51d2">linalg.opdsl.lang.comprehension.ReduceApply.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00321">comprehension.py:321</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply_html_a9e27c23b9e13e192320672b1796e1523"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a9e27c23b9e13e192320672b1796e1523">linalg.opdsl.lang.comprehension.PrimApply.collect_uses</a></div><div class="ttdeci">def collect_uses</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00286">comprehension.py:286</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_af16e2baa698b29ad36bd60cd1a6491c9"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#af16e2baa698b29ad36bd60cd1a6491c9">linalg.opdsl.lang.comprehension.LinalgOpDef.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00383">comprehension.py:383</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a54c87edaf7a3e43fc009f04d5a0182ec"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a54c87edaf7a3e43fc009f04d5a0182ec">linalg.opdsl.lang.comprehension.TensorDef.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00116">comprehension.py:116</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType_html_a342e4594c2ebe591dd03f3fbf8515c3e"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a342e4594c2ebe591dd03f3fbf8515c3e">linalg.opdsl.lang.comprehension.ReduceFnType.operator</a></div><div class="ttdeci">operator</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00253">comprehension.py:253</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_a0ee8d1ec3b746c4a4d91e3a897c8a598"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a0ee8d1ec3b746c4a4d91e3a897c8a598">linalg.opdsl.lang.comprehension.LinalgOpDef.inputs</a></div><div class="ttdeci">def inputs(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00392">comprehension.py:392</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html">linalg.opdsl.lang.comprehension.LinalgOpDef</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00379">comprehension.py:379</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast_html_a2f4025064f9d8b96651d5c4430515177"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a2f4025064f9d8b96651d5c4430515177">linalg.opdsl.lang.comprehension.cast.collect_uses</a></div><div class="ttdeci">def collect_uses</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00308">comprehension.py:308</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html_a8f871b5e8944f5b553dd333195a9ec88"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a8f871b5e8944f5b553dd333195a9ec88">linalg.opdsl.lang.comprehension.TensorExpression.collect_uses</a></div><div class="ttdeci">def collect_uses</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00045">comprehension.py:45</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef_html_a801f5085487094139fefacb2361d27e8"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html#a801f5085487094139fefacb2361d27e8">linalg.opdsl.lang.comprehension.OpInterfaceDef.cpp_name</a></div><div class="ttdeci">cpp_name</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00352">comprehension.py:352</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a9fe5712d63c4606309d3ac80e1be25cf"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a9fe5712d63c4606309d3ac80e1be25cf">linalg.opdsl.lang.comprehension.TensorDef.type_var</a></div><div class="ttdeci">type_var</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00123">comprehension.py:123</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef_html_aeba44172d4629929cf6e1b64fd242f63"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#aeba44172d4629929cf6e1b64fd242f63">linalg.opdsl.lang.comprehension.OpMetadataDef.implements</a></div><div class="ttdeci">implements</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00366">comprehension.py:366</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html">linalg.opdsl.lang.comprehension.PrimApply</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00270">comprehension.py:270</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef_html_afac87d852d434139e63957c8beb26497"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#afac87d852d434139e63957c8beb26497">linalg.opdsl.lang.comprehension.OpMetadataDef.cpp_class_name</a></div><div class="ttdeci">cpp_class_name</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00364">comprehension.py:364</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_a1f91d53e1a01e942419aef26fe8c66e7"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a1f91d53e1a01e942419aef26fe8c66e7">linalg.opdsl.lang.comprehension.LinalgOpDef.tensor</a></div><div class="ttdeci">def tensor(self, name)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00407">comprehension.py:407</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast_html_a2a9d61ad327e6fdabd79347dde07e0ee"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a2a9d61ad327e6fdabd79347dde07e0ee">linalg.opdsl.lang.comprehension.cast.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00311">comprehension.py:311</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_a7ba52198e7f358ce016b6c9e9dc7ea62"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a7ba52198e7f358ce016b6c9e9dc7ea62">linalg.opdsl.lang.comprehension.LinalgOpDef.comprehensions</a></div><div class="ttdeci">comprehensions</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00388">comprehension.py:388</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html">linalg.opdsl.lang.comprehension.ReduceApply</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00315">comprehension.py:315</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a8036f4196835e11f5f5470d3f76be9b9"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a8036f4196835e11f5f5470d3f76be9b9">linalg.opdsl.lang.comprehension.TensorDef.tensor_name</a></div><div class="ttdeci">tensor_name</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00127">comprehension.py:127</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_ae5572a5c3275c65616b177f2dd93d849"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#ae5572a5c3275c65616b177f2dd93d849">linalg.opdsl.lang.comprehension.TensorUse.__iadd__</a></div><div class="ttdeci">def __iadd__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00094">comprehension.py:94</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType_html_a038f03c4b832d6642ea973ea101048db"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a038f03c4b832d6642ea973ea101048db">linalg.opdsl.lang.comprehension.ReduceFnType.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00259">comprehension.py:259</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType_html_af7faa74bb77018a69b0691f2cc5a7383"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#af7faa74bb77018a69b0691f2cc5a7383">linalg.opdsl.lang.comprehension.PrimFnType.reduce</a></div><div class="ttdeci">def reduce</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00229">comprehension.py:229</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html">linalg.opdsl.lang.comprehension.ReduceFnType</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00246">comprehension.py:246</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_aff4a45ac36cf46e8f7e8bde33ff67efe"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#aff4a45ac36cf46e8f7e8bde33ff67efe">linalg.opdsl.lang.comprehension.TensorDef.shape</a></div><div class="ttdeci">shape</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00124">comprehension.py:124</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType_html_a4ee9313746f2fdf66001f25f50a9466d"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFnType.html#a4ee9313746f2fdf66001f25f50a9466d">linalg.opdsl.lang.comprehension.PrimFnType.prim_name</a></div><div class="ttdeci">prim_name</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00224">comprehension.py:224</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html">linalg.opdsl.lang.comprehension.TensorUse</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00062">comprehension.py:62</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html_af3e94e5e30080fa8306dabe897b72faa"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#af3e94e5e30080fa8306dabe897b72faa">linalg.opdsl.lang.comprehension.ReduceApply.reduce</a></div><div class="ttdeci">reduce</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00322">comprehension.py:322</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_a4d8db802177b8e2f445dc2a85a656d9f"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#a4d8db802177b8e2f445dc2a85a656d9f">linalg.opdsl.lang.comprehension.LinalgOpDef.add_tensor</a></div><div class="ttdeci">def add_tensor</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00399">comprehension.py:399</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_a2540073ea21353d279e50eb42211b807"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a2540073ea21353d279e50eb42211b807">linalg.opdsl.lang.comprehension.TensorUse.collect_uses</a></div><div class="ttdeci">def collect_uses</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00091">comprehension.py:91</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension_html_a8b43a28530a9c01834c55bd068d5afa1"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a8b43a28530a9c01834c55bd068d5afa1">linalg.opdsl.lang.comprehension.Comprehension.values</a></div><div class="ttdeci">values</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00187">comprehension.py:187</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType_html_a3657a5bbf8c376432138654b132a01cc"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a3657a5bbf8c376432138654b132a01cc">linalg.opdsl.lang.comprehension.ReduceFnType.reduce_dims</a></div><div class="ttdeci">reduce_dims</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00254">comprehension.py:254</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1affine_1_1AffineBuildState_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1affine_1_1AffineBuildState.html">linalg.opdsl.lang.affine.AffineBuildState</a></div><div class="ttdef"><b>Definition:</b> <a href="affine_8py_source.html#l00071">affine.py:71</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_add9793d6f4d2a833f964a67c565a61ec"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#add9793d6f4d2a833f964a67c565a61ec">linalg.opdsl.lang.comprehension.LinalgOpDef.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00414">comprehension.py:414</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a124f3d5bb2021028528a651f2b5c25e4"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a124f3d5bb2021028528a651f2b5c25e4">linalg.opdsl.lang.comprehension.TensorDef.__setitem__</a></div><div class="ttdeci">def __setitem__(self, dims, value)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00160">comprehension.py:160</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast_html_ab1b1e910ee80c2d8bf4cae08375390f3"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#ab1b1e910ee80c2d8bf4cae08375390f3">linalg.opdsl.lang.comprehension.cast.to_type</a></div><div class="ttdeci">to_type</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00298">comprehension.py:298</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html">linalg.opdsl.lang.comprehension.TensorDef</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00112">comprehension.py:112</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_afa359a51c020db58fbbf50e8a6a2af8a"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#afa359a51c020db58fbbf50e8a6a2af8a">linalg.opdsl.lang.comprehension.LinalgOpDef.metadata</a></div><div class="ttdeci">metadata</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00386">comprehension.py:386</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_a0d63edfe928909c4f50de93c29bfda18"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a0d63edfe928909c4f50de93c29bfda18">linalg.opdsl.lang.comprehension.TensorUse.indices</a></div><div class="ttdeci">indices</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00075">comprehension.py:75</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a66adc0a1c3e8e535c6f825dbe1cf3be5"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a66adc0a1c3e8e535c6f825dbe1cf3be5">linalg.opdsl.lang.comprehension.TensorDef.output</a></div><div class="ttdeci">output</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00126">comprehension.py:126</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_a907506b3b43d19e22741d707f8f3be70"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a907506b3b43d19e22741d707f8f3be70">linalg.opdsl.lang.comprehension.TensorUse.visit_affine_exprs</a></div><div class="ttdeci">def visit_affine_exprs(self, callback)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00087">comprehension.py:87</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast_html_ac1a303348e20186dea26a69bf6a9a6f0"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#ac1a303348e20186dea26a69bf6a9a6f0">linalg.opdsl.lang.comprehension.cast.visit_affine_exprs</a></div><div class="ttdeci">def visit_affine_exprs(self, callback)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00305">comprehension.py:305</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html_ae6a29824a3cea4ad2624f3044ed056d8"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#ae6a29824a3cea4ad2624f3044ed056d8">linalg.opdsl.lang.comprehension.ReduceApply.visit_affine_exprs</a></div><div class="ttdeci">def visit_affine_exprs(self, callback)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00334">comprehension.py:334</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply_html_ad1b2a9c3a44fc8f9cbfdf1f333eba124"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#ad1b2a9c3a44fc8f9cbfdf1f333eba124">linalg.opdsl.lang.comprehension.PrimApply.to_scalar_expression</a></div><div class="ttdeci">def to_scalar_expression(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00277">comprehension.py:277</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast_html_aa6a1a8d2335c03b8cdbb635999e478c0"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#aa6a1a8d2335c03b8cdbb635999e478c0">linalg.opdsl.lang.comprehension.cast.to_scalar_expression</a></div><div class="ttdeci">def to_scalar_expression(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00301">comprehension.py:301</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html_a02308d11b08a59b7e7f8c75487888721"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a02308d11b08a59b7e7f8c75487888721">linalg.opdsl.lang.comprehension.TensorExpression.__sub__</a></div><div class="ttdeci">def __sub__(self, rhs)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00055">comprehension.py:55</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension_html_a9acdc41c924c3514a560e25a75e93027"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a9acdc41c924c3514a560e25a75e93027">linalg.opdsl.lang.comprehension.Comprehension.all_reduction_dims</a></div><div class="ttdeci">def all_reduction_dims(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00199">comprehension.py:199</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply_html_a4d0cc96bb15db3929307eb28ecd57303"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a4d0cc96bb15db3929307eb28ecd57303">linalg.opdsl.lang.comprehension.PrimApply.prim</a></div><div class="ttdeci">prim</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00274">comprehension.py:274</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a6710870f6492a6929d64d846b0ffd750"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a6710870f6492a6929d64d846b0ffd750">linalg.opdsl.lang.comprehension.TensorDef.owner</a></div><div class="ttdeci">owner</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00122">comprehension.py:122</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_a9d614ddb67eb3b61204a3c8c27f835fc"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#a9d614ddb67eb3b61204a3c8c27f835fc">linalg.opdsl.lang.comprehension.TensorDef.attach</a></div><div class="ttdeci">def attach</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00135">comprehension.py:135</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html_a1dfe98c8ab7553fa2bd82c8d7b33d913"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a1dfe98c8ab7553fa2bd82c8d7b33d913">linalg.opdsl.lang.comprehension.TensorExpression.__mul__</a></div><div class="ttdeci">def __mul__(self, rhs)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00052">comprehension.py:52</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpInterfaceDef.html">linalg.opdsl.lang.comprehension.OpInterfaceDef</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00348">comprehension.py:348</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply_html_a9c0964fef9a9dc4bc34c4359d02a3e92"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#a9c0964fef9a9dc4bc34c4359d02a3e92">linalg.opdsl.lang.comprehension.PrimApply.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00273">comprehension.py:273</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarArg_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarArg.html">linalg.opdsl.lang.scalar_expr.ScalarArg</a></div><div class="ttdef"><b>Definition:</b> <a href="scalar__expr_8py_source.html#l00044">scalar_expr.py:44</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html_a3eff16d4310fe6502328ce890e12fb46"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#a3eff16d4310fe6502328ce890e12fb46">linalg.opdsl.lang.comprehension.TensorExpression.__hash__</a></div><div class="ttdeci">def __hash__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00058">comprehension.py:58</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimFn.html">linalg.opdsl.lang.comprehension.PrimFn</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00237">comprehension.py:237</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_ad0ea181b0b010955f00391e925d4e1e0"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#ad0ea181b0b010955f00391e925d4e1e0">linalg.opdsl.lang.comprehension.LinalgOpDef.registered_tensors</a></div><div class="ttdeci">registered_tensors</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00387">comprehension.py:387</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType_html_a5d0597e534a0115d6f99b54a6629e0bf"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a5d0597e534a0115d6f99b54a6629e0bf">linalg.opdsl.lang.comprehension.ReduceFnType.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00249">comprehension.py:249</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType_html_a536d883c506d44c9a6215cf6780c6a11"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFnType.html#a536d883c506d44c9a6215cf6780c6a11">linalg.opdsl.lang.comprehension.ReduceFnType.__call__</a></div><div class="ttdeci">def __call__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00256">comprehension.py:256</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef_html_adcb5271ae1d3db4adcf9e932681edcce"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1LinalgOpDef.html#adcb5271ae1d3db4adcf9e932681edcce">linalg.opdsl.lang.comprehension.LinalgOpDef.outputs</a></div><div class="ttdeci">def outputs(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00396">comprehension.py:396</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast_html_a83dcb8567c9c7ecd4647ed3a6a03804b"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a83dcb8567c9c7ecd4647ed3a6a03804b">linalg.opdsl.lang.comprehension.cast.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00297">comprehension.py:297</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply_html_ab5422aa4aad2f31c59f7240dd3d5bc8a"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1PrimApply.html#ab5422aa4aad2f31c59f7240dd3d5bc8a">linalg.opdsl.lang.comprehension.PrimApply.visit_affine_exprs</a></div><div class="ttdeci">def visit_affine_exprs(self, callback)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00282">comprehension.py:282</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html_aac3471e85cf22ac516e101e9d891d215"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#aac3471e85cf22ac516e101e9d891d215">linalg.opdsl.lang.comprehension.ReduceApply.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00344">comprehension.py:344</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_ae9f66b4439d159d20746c2d4316303dc"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#ae9f66b4439d159d20746c2d4316303dc">linalg.opdsl.lang.comprehension.TensorDef.registered_index</a></div><div class="ttdeci">registered_index</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00128">comprehension.py:128</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast_html_a5e564b4bf2d423f451aff2e6ed4bf48a"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1cast.html#a5e564b4bf2d423f451aff2e6ed4bf48a">linalg.opdsl.lang.comprehension.cast.operand</a></div><div class="ttdeci">operand</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00299">comprehension.py:299</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarSymbolicCast_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1scalar__expr_1_1ScalarSymbolicCast.html">linalg.opdsl.lang.scalar_expr.ScalarSymbolicCast</a></div><div class="ttdef"><b>Definition:</b> <a href="scalar__expr_8py_source.html#l00057">scalar_expr.py:57</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html_adb1e5f229344d18b658b24f284d55c47"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html#adb1e5f229344d18b658b24f284d55c47">linalg.opdsl.lang.comprehension.TensorExpression.visit_affine_exprs</a></div><div class="ttdeci">def visit_affine_exprs(self, callback)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00030">comprehension.py:30</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFn_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceFn.html">linalg.opdsl.lang.comprehension.ReduceFn</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00264">comprehension.py:264</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression_html"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorExpression.html">linalg.opdsl.lang.comprehension.TensorExpression</a></div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00024">comprehension.py:24</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef_html_acdc2ba8b78607d25ffabcc58e7d34a89"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorDef.html#acdc2ba8b78607d25ffabcc58e7d34a89">linalg.opdsl.lang.comprehension.TensorDef.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00176">comprehension.py:176</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef_html_a2b0baa286b8cd65a1d739df2405477c6"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#a2b0baa286b8cd65a1d739df2405477c6">linalg.opdsl.lang.comprehension.OpMetadataDef.to_yaml_custom_dict</a></div><div class="ttdeci">def to_yaml_custom_dict(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00368">comprehension.py:368</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef_html_a79b808a15e62c0c811fe47c43d7269dc"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#a79b808a15e62c0c811fe47c43d7269dc">linalg.opdsl.lang.comprehension.OpMetadataDef.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00362">comprehension.py:362</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_a279cd088f6f198f5b2361c07794948d3"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#a279cd088f6f198f5b2361c07794948d3">linalg.opdsl.lang.comprehension.TensorUse.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00073">comprehension.py:73</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply_html_a7d2455e9e1bdb7b6fe18aed2fe73b2b9"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1ReduceApply.html#a7d2455e9e1bdb7b6fe18aed2fe73b2b9">linalg.opdsl.lang.comprehension.ReduceApply.to_scalar_expression</a></div><div class="ttdeci">def to_scalar_expression(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00326">comprehension.py:326</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse_html_aef5f67b86e112ffeae40ce1588963ca8"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1TensorUse.html#aef5f67b86e112ffeae40ce1588963ca8">linalg.opdsl.lang.comprehension.TensorUse.tensor_name</a></div><div class="ttdeci">def tensor_name(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00082">comprehension.py:82</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension_html_a1d500ad7e0f16fb05400b832d9bc42e4"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1Comprehension.html#a1d500ad7e0f16fb05400b832d9bc42e4">linalg.opdsl.lang.comprehension.Comprehension.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00209">comprehension.py:209</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef_html_ae76d5f02087ef4c671b65f2b51821f36"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#ae76d5f02087ef4c671b65f2b51821f36">linalg.opdsl.lang.comprehension.OpMetadataDef.name</a></div><div class="ttdeci">name</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00363">comprehension.py:363</a></div></div>
<div class="ttc" id="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef_html_ad017798fea096c33f7774beb4add208b"><div class="ttname"><a href="classlinalg_1_1opdsl_1_1lang_1_1comprehension_1_1OpMetadataDef.html#ad017798fea096c33f7774beb4add208b">linalg.opdsl.lang.comprehension.OpMetadataDef.doc</a></div><div class="ttdeci">doc</div><div class="ttdef"><b>Definition:</b> <a href="comprehension_8py_source.html#l00365">comprehension.py:365</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 8 2021 12:36:25 for MLIR by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
